
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Kubernetes (YAML) · Ambassador: open source API Gateway for microservices and Kubernetes</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="../styles/website.css">
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/ambassador-v0.40.0-docs/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/ambassador-v0.40.0-docs/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="helm.html" />
    
    
    <link rel="prev" href="install.html" />
    

    </head>
    <body>
        
    <noscript>
        <iframe src="//www.googletagmanager.com/ns.html?id=GTM-TPMQ838" height="0" width="0" style="display:none;visibility:hidden"></iframe>
    </noscript>
    <script>
        (function(w,d,s,l,i){
            w[l]=w[l]||[];
            w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});
            var f=d.getElementsByTagName(s)[0],
                j=d.createElement(s),
                dl=l!='dataLayer'?'&l='+l:'';
            j.async=true;
            j.src='//www.googletagmanager.com/gtm.js?id='+i+dl;
            f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-TPMQ838');
    </script>
    
<div class="book">
    <div class="book-summary">
        
<a href="/" class="logo__link">
    <img class="logo" src="/ambassador-v0.40.0-docs/images/ambassador-logo.svg" alt="logo">
</a>


            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <a target="_blank" href="https://blog.getambassador.io">
            
                    
                    Blog
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Getting Started</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../about/why-ambassador.html">
            
                <a href="../about/why-ambassador.html">
            
                    
                    Why Ambassador?
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="../about/features-and-benefits.html">
            
                <a href="../about/features-and-benefits.html">
            
                    
                    Features and Benefits
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="install.html">
            
                <a href="install.html">
            
                    
                    Installing Ambassador
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="2.3.1" data-path="getting-started.html">
            
                <a href="getting-started.html">
            
                    
                    Kubernetes (YAML)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.2" data-path="helm.html">
            
                <a href="helm.html">
            
                    
                    Kubernetes (Helm)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.3" data-path="../about/quickstart.html">
            
                <a href="../about/quickstart.html">
            
                    
                    Docker Quickstart
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.4" data-path="docker-compose.html">
            
                <a href="docker-compose.html">
            
                    
                    Docker Compose
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Concepts</li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="../concepts/developers.html">
            
                <a href="../concepts/developers.html">
            
                    
                    Decentralized configuration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="../concepts/architecture.html">
            
                <a href="../concepts/architecture.html">
            
                    
                    Ambassador Architecture
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.2.1" >
            
                <a target="_blank" href="https://blog.getambassador.io/envoy-vs-nginx-vs-haproxy-why-the-open-source-ambassador-api-gateway-chose-envoy-23826aed79ef">
            
                    
                    Why Ambassador uses Envoy Proxy
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="../about/microservices-api-gateways.html">
            
                <a href="../about/microservices-api-gateways.html">
            
                    
                    Microservices API Gateways
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="../concepts/using-ambassador-in-org.html">
            
                <a href="../concepts/using-ambassador-in-org.html">
            
                    
                    Using Ambassador in your organization
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Guides</li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="auth-tutorial.html">
            
                <a href="auth-tutorial.html">
            
                    
                    Adding Authentication
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="rate-limiting-tutorial.html">
            
                <a href="rate-limiting-tutorial.html">
            
                    
                    Adding Rate Limiting
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="tracing-tutorial.html">
            
                <a href="tracing-tutorial.html">
            
                    
                    Adding Tracing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.4" data-path="grpc.html">
            
                <a href="grpc.html">
            
                    
                    Use gRPC with Ambassador
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.5" data-path="tls-termination.html">
            
                <a href="tls-termination.html">
            
                    
                    TLS Termination
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.6" data-path="with-istio.html">
            
                <a href="with-istio.html">
            
                    
                    Istio and Ambassador
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.7" >
            
                <a target="_blank" href="https://blog.getambassador.io/howto/home">
            
                    
                    More guides
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Reference</li>
        
        
    
        <li class="chapter " data-level="5.1" data-path="../reference/configuration.html">
            
                <a href="../reference/configuration.html">
            
                    
                    Configuring Ambassador
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1.1" data-path="../reference/modules.html">
            
                <a href="../reference/modules.html">
            
                    
                    Core Configuration
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1.1.1" data-path="../reference/core/tls.html">
            
                <a href="../reference/core/tls.html">
            
                    
                    TLS and X-Forwarded-Proto
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5.1.2" data-path="../reference/mappings.html">
            
                <a href="../reference/mappings.html">
            
                    
                    Configuring Services
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1.2.1" data-path="../reference/canary.html">
            
                <a href="../reference/canary.html">
            
                    
                    Canary Releases
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.2.2" data-path="../reference/cors.html">
            
                <a href="../reference/cors.html">
            
                    
                    Cross Origin Resource Sharing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.2.3" data-path="../reference/override.html">
            
                <a href="../reference/override.html">
            
                    
                    Custom Envoy config
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.2.4" data-path="../reference/headers.html">
            
                <a href="../reference/headers.html">
            
                    
                    Header-based routing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.2.5" data-path="../reference/host.html">
            
                <a href="../reference/host.html">
            
                    
                    Host Header
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.2.6" data-path="../reference/rate-limits.html">
            
                <a href="../reference/rate-limits.html">
            
                    
                    Rate Limits
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.2.7" data-path="../reference/redirects.html">
            
                <a href="../reference/redirects.html">
            
                    
                    Redirects
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.2.8" data-path="../reference/add_request_headers.html">
            
                <a href="../reference/add_request_headers.html">
            
                    
                    Request Headers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.2.9" data-path="../reference/rewrites.html">
            
                <a href="../reference/rewrites.html">
            
                    
                    Rewrites
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.2.10" data-path="../reference/shadowing.html">
            
                <a href="../reference/shadowing.html">
            
                    
                    Traffic Shadowing
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5.1.3" data-path="../reference/services/services.html">
            
                <a href="../reference/services/services.html">
            
                    
                    External Services
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1.3.1" data-path="../reference/services/auth-service.html">
            
                <a href="../reference/services/auth-service.html">
            
                    
                    Authentication
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.3.2" data-path="../reference/services/rate-limit-service.html">
            
                <a href="../reference/services/rate-limit-service.html">
            
                    
                    Rate Limiting
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.3.3" data-path="../reference/services/tracing-service.html">
            
                <a href="../reference/services/tracing-service.html">
            
                    
                    Tracing
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5.1.4" data-path="../reference/advanced.html">
            
                <a href="../reference/advanced.html">
            
                    
                    Advanced configuration topics
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="../reference/running.html">
            
                <a href="../reference/running.html">
            
                    
                    Running Ambassador
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.2.1" data-path="../reference/diagnostics.html">
            
                <a href="../reference/diagnostics.html">
            
                    
                    Diagnostics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2.2" data-path="../reference/ambassador-with-aws.html">
            
                <a href="../reference/ambassador-with-aws.html">
            
                    
                    Ambassador with AWS
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5.3" data-path="../reference/upgrading.html">
            
                <a href="../reference/upgrading.html">
            
                    
                    Upgrading Ambassador
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.4" data-path="../reference/statistics.html">
            
                <a href="../reference/statistics.html">
            
                    
                    Statistics and Monitoring
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Developers</li>
        
        
    
        <li class="chapter " data-level="6.1" >
            
                <a target="_blank" href="https://github.com/datawire/ambassador/blob/master/BUILDING.md">
            
                    
                    Building Ambassador (GitHub)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.2" >
            
                <a target="_blank" href="https://github.com/datawire/ambassador/blob/master/CHANGELOG.md">
            
                    
                    Changelog (GitHub)
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Need Help?</li>
        
        
    
        <li class="chapter " data-level="7.1" >
            
                <a target="_blank" href="https://d6e.co/slack">
            
                    
                    Ask on Slack
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.2" >
            
                <a target="_blank" href="https://github.com/datawire/ambassador/issues/new">
            
                    
                    File a GitHub Issue
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.3" >
            
                <a target="_blank" href="https://www.datawire.io">
            
                    
                    Visit Datawire.io
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        

    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Kubernetes (YAML)</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
<a id="datawire-breadcrumb" href="https://datawire.io/learn/open-source-docs">
    ← Back to Datawire Open Source Documentation
</a>

                                <h1 id="deploying-ambassador-to-kubernetes">Deploying Ambassador to Kubernetes</h1>
<p>In this tutorial, we&apos;ll walk through the process of deploying Ambassador in Kubernetes for ingress routing. Ambassador provides all the functionality of a traditional ingress controller (i.e., path-based routing) while exposing many additional capabilities such as <a href="auth-tutorial">authentication</a>, URL rewriting, CORS, rate limiting, and automatic metrics collection (the <a href="../reference/mappings">mappings reference</a> contains a full list of supported options). For more background on Kubernetes ingress, <a href="https://blog.getambassador.io/kubernetes-ingress-nodeport-load-balancers-and-ingress-controllers-6e29f1c44f2d" target="_blank">read this blog post</a>.</p>
<p>Ambassador is designed to allow service authors to control how their service is published to the Internet. We accomplish this by permitting a wide range of annotations on the <em>service</em>, which Ambassador reads to configure its Envoy Proxy. Below, we&apos;ll use service annotations to configure Ambassador to map <code>/httpbin/</code> to <code>httpbin.org</code>.</p>
<h2 id="1-deploying-ambassador">1. Deploying Ambassador</h2>
<p>To deploy Ambassador in your default namespace, first you need to check if Kubernetes has RBAC enabled:</p>
<pre><code class="lang-shell">kubectl cluster-info dump --namespace kube-system | grep authorization-mode
</code></pre>
<p>If you see something like <code>--authorization-mode=Node,RBAC</code> in the output, then RBAC is enabled. The majority of current hosted Kubernetes providers (such as GKE) create
clusters with RBAC enabled by default, and unfortunately the above command may not return any information indicating this.</p>
<p>Note: If you&apos;re using Google Kubernetes Engine with RBAC, you&apos;ll need to grant permissions to the account that will be setting up Ambassador. To do this, get your official GKE username, and then grant <code>cluster-admin</code> role privileges to that username:</p>
<pre><code>$ kubectl create clusterrolebinding my-cluster-admin-binding --clusterrole=cluster-admin --user=$(gcloud info --format=&quot;value(config.account)&quot;)
</code></pre><p>If RBAC is enabled:</p>
<pre><code class="lang-shell">kubectl apply -f https://getambassador.io/yaml/ambassador/ambassador-rbac.yaml
</code></pre>
<p>Without RBAC, you can use:</p>
<pre><code class="lang-shell">kubectl apply -f https://getambassador.io/yaml/ambassador/ambassador-no-rbac.yaml
</code></pre>
<p>We recommend downloading the YAML files and exploring the content. You will see
that an <code>ambassador-admin</code> NodePort Service is created (which provides an
Ambassador Diagnostic web UI), along with an ambassador ClusterRole, ServiceAccount and ClusterRoleBinding (if RBAC is enabled). An Ambassador Deployment is also created.</p>
<p>For production configurations, we recommend you download these YAML files as your starting point, and customize them accordingly (e.g., your namespace).</p>
<h2 id="2-defining-the-ambassador-service">2. Defining the Ambassador Service</h2>
<p>Ambassador is deployed as a Kubernetes Service that references the ambassador
Deployment you deployed previously. Create the following YAML and put it in a file called <code>ambassador-service.yaml</code>.</p>
<pre><code class="lang-yaml"><span class="hljs-meta">---</span>
<span class="hljs-attr">apiVersion:</span> v1
<span class="hljs-attr">kind:</span> Service
<span class="hljs-attr">metadata:</span>
<span class="hljs-attr">  name:</span> ambassador
<span class="hljs-attr">spec:</span>
<span class="hljs-attr">  type:</span> LoadBalancer
<span class="hljs-attr">  ports:</span>
<span class="hljs-attr">   - port:</span> <span class="hljs-number">80</span>
<span class="hljs-attr">  selector:</span>
<span class="hljs-attr">    service:</span> ambassador
</code></pre>
<p>Deploy this service with <code>kubectl</code>:</p>
<pre><code class="lang-shell">$ kubectl apply -f ambassador-service.yaml
</code></pre>
<p>The YAML above creates a Kubernetes service for Ambassador of type <code>LoadBalancer</code>. All HTTP traffic will be evaluated against the routing rules you create. Note that if you&apos;re not deploying in an environment where <code>LoadBalancer</code> is a supported type (such as minikube), you&apos;ll need to change this to a different type of service, e.g., <code>NodePort</code>.</p>
<h2 id="3-creating-your-first-route">3. Creating your first route</h2>
<p>Create the following YAML and put it in a file called <code>httpbin.yaml</code>.</p>
<pre><code class="lang-yaml"><span class="hljs-meta">---</span>
<span class="hljs-attr">apiVersion:</span> v1
<span class="hljs-attr">kind:</span> Service
<span class="hljs-attr">metadata:</span>
<span class="hljs-attr">  name:</span> httpbin
<span class="hljs-attr">  annotations:</span>
    getambassador.io/config: <span class="hljs-string">|
      ---
</span><span class="hljs-attr">      apiVersion:</span> ambassador/v0
<span class="hljs-attr">      kind:</span>  Mapping
<span class="hljs-attr">      name:</span>  httpbin_mapping
<span class="hljs-attr">      prefix:</span> /httpbin/
<span class="hljs-attr">      service:</span> httpbin.org:<span class="hljs-number">80</span>
<span class="hljs-attr">      host_rewrite:</span> httpbin.org
<span class="hljs-attr">spec:</span>
<span class="hljs-attr">  ports:</span>
<span class="hljs-attr">  - name:</span> httpbin
<span class="hljs-attr">    port:</span> <span class="hljs-number">80</span>
</code></pre>
<p>Then, apply it to the Kubernetes with <code>kubectl</code>:</p>
<pre><code class="lang-shell">$ kubectl apply -f httpbin.yaml
</code></pre>
<p>When the service is deployed, Ambassador will notice the <code>getambassador.io/config</code> annotation on the service, and use the <code>Mapping</code> contained in it to configure the route.  (There&apos;s no restriction on what kinds of Ambassador configuration can go into the annotation, but it&apos;s important to note that Ambassador only looks at annotations on Kubernetes <code>Service</code>s.)</p>
<p>In this case, the mapping creates a route that will route traffic from the <code>/httpbin/</code> endpoint to the public <code>httpbin.org</code> service. Note that we are using the <code>host_rewrite</code> attribute for the <code>httpbin_mapping</code> &#x2014; this forces the HTTP <code>Host</code> header, and is often a good idea when mapping to external services. Ambassador supports <a href="../reference/configuration">many different configuration options</a>.</p>
<h2 id="4-testing-the-mapping">4. Testing the Mapping</h2>
<p>To test things out, we&apos;ll need the external IP for Ambassador (it might take some time for this to be available):</p>
<pre><code class="lang-shell">kubectl get svc -o wide ambassador
</code></pre>
<p>Eventually, this should give you something like:</p>
<pre><code>NAME         CLUSTER-IP      EXTERNAL-IP     PORT(S)        AGE
ambassador   10.11.12.13     35.36.37.38     80:31656/TCP   1m
</code></pre><p>You should now be able to use <code>curl</code> to <code>httpbin</code> (don&apos;t forget the trailing <code>/</code>):</p>
<pre><code class="lang-shell">$ curl 35.36.37.38/httpbin/
</code></pre>
<p>or on minikube:</p>
<pre><code class="lang-shell">$ minikube service list
|-------------|----------------------|-----------------------------|
|  NAMESPACE  |         NAME         |             URL             |
|-------------|----------------------|-----------------------------|
| default     | ambassador-admin     | http://192.168.99.107:30319 |
| default     | ambassador           | http://192.168.99.107:31893 |
|-------------|----------------------|-----------------------------|
$ curl http://192.168.99.107:31893/httpbin/
</code></pre>
<p>or on Docker for Mac/Windows</p>
<pre><code class="lang-shell">$ kubectl get svc
NAME               TYPE           CLUSTER-IP       EXTERNAL-IP   PORT(S)          AGE
ambassador         LoadBalancer   10.106.108.64    localhost     80:32324/TCP     13m
ambassador-admin   NodePort       10.107.188.149   &lt;none&gt;        8877:30993/TCP   14m
httpbin            ClusterIP      10.107.77.153    &lt;none&gt;        80/TCP           13m
kubernetes         ClusterIP      10.96.0.1        &lt;none&gt;        443/TCP          84d
$ curl http://localhost/httpbin/
</code></pre>
<h2 id="5-adding-a-service">5. Adding a Service</h2>
<p>You can add a Service route simply by deploying it with an appropriate Ambassador annotation. For example, we can deploy the QoTM service locally in this cluster, and automatically map it through Ambassador by creating <code>qotm.yaml</code> with the following configuration:</p>
<pre><code class="lang-yaml"><span class="hljs-meta">---</span>
<span class="hljs-attr">apiVersion:</span> v1
<span class="hljs-attr">kind:</span> Service
<span class="hljs-attr">metadata:</span>
<span class="hljs-attr">  name:</span> qotm
<span class="hljs-attr">  annotations:</span>
    getambassador.io/config: <span class="hljs-string">|
      ---
</span><span class="hljs-attr">      apiVersion:</span> ambassador/v0
<span class="hljs-attr">      kind:</span>  Mapping
<span class="hljs-attr">      name:</span>  qotm_mapping
<span class="hljs-attr">      prefix:</span> /qotm/
<span class="hljs-attr">      service:</span> qotm
<span class="hljs-attr">spec:</span>
<span class="hljs-attr">  selector:</span>
<span class="hljs-attr">    app:</span> qotm
<span class="hljs-attr">  ports:</span>
<span class="hljs-attr">  - port:</span> <span class="hljs-number">80</span>
<span class="hljs-attr">    name:</span> http-qotm
<span class="hljs-attr">    targetPort:</span> http-api
<span class="hljs-meta">---</span>
<span class="hljs-attr">apiVersion:</span> extensions/v1beta1
<span class="hljs-attr">kind:</span> Deployment
<span class="hljs-attr">metadata:</span>
<span class="hljs-attr">  name:</span> qotm
<span class="hljs-attr">spec:</span>
<span class="hljs-attr">  replicas:</span> <span class="hljs-number">1</span>
<span class="hljs-attr">  strategy:</span>
<span class="hljs-attr">    type:</span> RollingUpdate
<span class="hljs-attr">  template:</span>
<span class="hljs-attr">    metadata:</span>
<span class="hljs-attr">      labels:</span>
<span class="hljs-attr">        app:</span> qotm
<span class="hljs-attr">    spec:</span>
<span class="hljs-attr">      containers:</span>
<span class="hljs-attr">      - name:</span> qotm
<span class="hljs-attr">        image:</span> datawire/qotm:<span class="hljs-number">1.1</span>
<span class="hljs-attr">        ports:</span>
<span class="hljs-attr">        - name:</span> http-api
<span class="hljs-attr">          containerPort:</span> <span class="hljs-number">5000</span>
<span class="hljs-attr">        resources:</span>
<span class="hljs-attr">          limits:</span>
<span class="hljs-attr">            cpu:</span> <span class="hljs-string">&quot;0.1&quot;</span>
<span class="hljs-attr">            memory:</span> <span class="hljs-number">100</span>Mi
</code></pre>
<p>and then applying it with:</p>
<pre><code>kubectl apply -f qotm.yaml
</code></pre><p>A few seconds after the QoTM service is running, Ambassador should be configured for it. Try it with</p>
<pre><code class="lang-shell">$ curl http://${AMBASSADOR_IP}/qotm/
</code></pre>
<h2 id="6-the-diagnostics-service-in-kubernetes">6. The Diagnostics Service in Kubernetes</h2>
<p>Ambassador includes an integrated diagnostics service to help with troubleshooting. By default, this is not exposed to the Internet. To view it, we&apos;ll need to get the name of one of the Ambassador pods:</p>
<pre><code>$ kubectl get pods
NAME                          READY     STATUS    RESTARTS   AGE
ambassador-3655608000-43x86   1/1       Running   0          2m
ambassador-3655608000-w63zf   1/1       Running   0          2m
</code></pre><p>Forwarding local port 8877 to one of the pods:</p>
<pre><code>kubectl port-forward ambassador-3655608000-43x86 8877
</code></pre><p>will then let us view the diagnostics at <a href="http://localhost:8877/ambassador/v0/diag/" target="_blank">http://localhost:8877/ambassador/v0/diag/</a>.</p>
<h2 id="7-next">7. Next</h2>
<p>We&apos;ve just done a quick tour of some of the core features of Ambassador: diagnostics, routing, configuration, and authentication.</p>
<ul>
<li>Join us on <a href="https://join.slack.com/t/datawire-oss/shared_invite/enQtMzcwMDEwMTc5ODQ3LTE1NmIzZTFmZWE0OTQ1NDc2MzE2NTkzMDAzZWM0MDIxZTVjOGIxYmRjZjY3N2M2Mjk4NGI5Y2Q4NGY4Njc1Yjg" target="_blank">Slack</a>;</li>
<li>Learn how to <a href="auth-tutorial.html">add authentication</a> to existing services; or</li>
<li>Learn how to <a href="rate-limiting-tutorial.html">add rate limiting</a> to existing services; or</li>
<li>Learn how to <a href="tracing-tutorial.html">add tracing</a>; or</li>
<li>Learn how to <a href="grpc.html">use gRPC with Ambassador</a>; or</li>
<li>Read about <a href="../reference/configuration.html">configuring Ambassador</a>.</li>
</ul>

                                

                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="install.html" class="navigation navigation-prev " aria-label="Previous page: Installing Ambassador">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="helm.html" class="navigation navigation-next " aria-label="Next page: Kubernetes (Helm)">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Kubernetes (YAML)","level":"2.3.1","depth":2,"next":{"title":"Kubernetes (Helm)","level":"2.3.2","depth":2,"path":"user-guide/helm.md","ref":"user-guide/helm.md","articles":[]},"previous":{"title":"Installing Ambassador","level":"2.3","depth":1,"path":"user-guide/install.md","ref":"user-guide/install.md","articles":[{"title":"Kubernetes (YAML)","level":"2.3.1","depth":2,"path":"user-guide/getting-started.md","ref":"user-guide/getting-started.md","articles":[]},{"title":"Kubernetes (Helm)","level":"2.3.2","depth":2,"path":"user-guide/helm.md","ref":"user-guide/helm.md","articles":[]},{"title":"Docker Quickstart","level":"2.3.3","depth":2,"path":"about/quickstart.md","ref":"about/quickstart.md","articles":[]},{"title":"Docker Compose","level":"2.3.4","depth":2,"path":"user-guide/docker-compose.md","ref":"user-guide/docker-compose.md","articles":[]}]},"dir":"ltr"},"config":{"plugins":["gtm","anchorjs"],"root":".","styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"gtm":{"token":"GTM-TPMQ838","virtualPageViews":true},"search":{},"layout":{"footerPath":"layouts/footer.html"},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"anchorjs":{"selector":"h2,h3,h4,h5","placement":"right","visible":"always","truncate":64,"ariaLabel":"Anchor"}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"INDEX.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"Ambassador: open source API Gateway for microservices and Kubernetes","gitbook":"*"},"file":{"path":"user-guide/getting-started.md","mtime":"2020-08-25T18:44:25.448Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2020-09-14T18:10:30.972Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>


        
    
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-gtm/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-anchorjs/anchor.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-anchorjs/anchor-style.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    <script src="/js/datawire-breadcrumb.js" type="text/javascript"></script>

    </body>
</html>


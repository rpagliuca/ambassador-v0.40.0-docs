
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Statistics and Monitoring Â· Ambassador: open source API Gateway for microservices and Kubernetes</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="../styles/website.css">
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/ambassador-v0.40.0-docs/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/ambassador-v0.40.0-docs/images/favicon.ico" type="image/x-icon">

    
    
    <link rel="prev" href="upgrading.html" />
    

    </head>
    <body>
        
    <noscript>
        <iframe src="//www.googletagmanager.com/ns.html?id=GTM-TPMQ838" height="0" width="0" style="display:none;visibility:hidden"></iframe>
    </noscript>
    <script>
        (function(w,d,s,l,i){
            w[l]=w[l]||[];
            w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});
            var f=d.getElementsByTagName(s)[0],
                j=d.createElement(s),
                dl=l!='dataLayer'?'&l='+l:'';
            j.async=true;
            j.src='//www.googletagmanager.com/gtm.js?id='+i+dl;
            f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-TPMQ838');
    </script>
    
<div class="book">
    <div class="book-summary">
        
<a href="/" class="logo__link">
    <img class="logo" src="/ambassador-v0.40.0-docs/images/ambassador-logo.svg" alt="logo">
</a>


            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <a target="_blank" href="https://blog.getambassador.io">
            
                    
                    Blog
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Getting Started</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../about/why-ambassador.html">
            
                <a href="../about/why-ambassador.html">
            
                    
                    Why Ambassador?
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="../about/features-and-benefits.html">
            
                <a href="../about/features-and-benefits.html">
            
                    
                    Features and Benefits
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="../user-guide/install.html">
            
                <a href="../user-guide/install.html">
            
                    
                    Installing Ambassador
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.3.1" data-path="../user-guide/getting-started.html">
            
                <a href="../user-guide/getting-started.html">
            
                    
                    Kubernetes (YAML)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.2" data-path="../user-guide/helm.html">
            
                <a href="../user-guide/helm.html">
            
                    
                    Kubernetes (Helm)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.3" data-path="../about/quickstart.html">
            
                <a href="../about/quickstart.html">
            
                    
                    Docker Quickstart
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.4" data-path="../user-guide/docker-compose.html">
            
                <a href="../user-guide/docker-compose.html">
            
                    
                    Docker Compose
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Concepts</li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="../concepts/developers.html">
            
                <a href="../concepts/developers.html">
            
                    
                    Decentralized configuration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="../concepts/architecture.html">
            
                <a href="../concepts/architecture.html">
            
                    
                    Ambassador Architecture
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.2.1" >
            
                <a target="_blank" href="https://blog.getambassador.io/envoy-vs-nginx-vs-haproxy-why-the-open-source-ambassador-api-gateway-chose-envoy-23826aed79ef">
            
                    
                    Why Ambassador uses Envoy Proxy
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="../about/microservices-api-gateways.html">
            
                <a href="../about/microservices-api-gateways.html">
            
                    
                    Microservices API Gateways
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="../concepts/using-ambassador-in-org.html">
            
                <a href="../concepts/using-ambassador-in-org.html">
            
                    
                    Using Ambassador in your organization
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Guides</li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="../user-guide/auth-tutorial.html">
            
                <a href="../user-guide/auth-tutorial.html">
            
                    
                    Adding Authentication
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="../user-guide/rate-limiting-tutorial.html">
            
                <a href="../user-guide/rate-limiting-tutorial.html">
            
                    
                    Adding Rate Limiting
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="../user-guide/tracing-tutorial.html">
            
                <a href="../user-guide/tracing-tutorial.html">
            
                    
                    Adding Tracing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.4" data-path="../user-guide/grpc.html">
            
                <a href="../user-guide/grpc.html">
            
                    
                    Use gRPC with Ambassador
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.5" data-path="../user-guide/tls-termination.html">
            
                <a href="../user-guide/tls-termination.html">
            
                    
                    TLS Termination
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.6" data-path="../user-guide/with-istio.html">
            
                <a href="../user-guide/with-istio.html">
            
                    
                    Istio and Ambassador
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.7" >
            
                <a target="_blank" href="https://blog.getambassador.io/howto/home">
            
                    
                    More guides
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Reference</li>
        
        
    
        <li class="chapter " data-level="5.1" data-path="configuration.html">
            
                <a href="configuration.html">
            
                    
                    Configuring Ambassador
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1.1" data-path="modules.html">
            
                <a href="modules.html">
            
                    
                    Core Configuration
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1.1.1" data-path="core/tls.html">
            
                <a href="core/tls.html">
            
                    
                    TLS and X-Forwarded-Proto
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5.1.2" data-path="mappings.html">
            
                <a href="mappings.html">
            
                    
                    Configuring Services
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1.2.1" data-path="canary.html">
            
                <a href="canary.html">
            
                    
                    Canary Releases
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.2.2" data-path="cors.html">
            
                <a href="cors.html">
            
                    
                    Cross Origin Resource Sharing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.2.3" data-path="override.html">
            
                <a href="override.html">
            
                    
                    Custom Envoy config
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.2.4" data-path="headers.html">
            
                <a href="headers.html">
            
                    
                    Header-based routing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.2.5" data-path="host.html">
            
                <a href="host.html">
            
                    
                    Host Header
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.2.6" data-path="rate-limits.html">
            
                <a href="rate-limits.html">
            
                    
                    Rate Limits
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.2.7" data-path="redirects.html">
            
                <a href="redirects.html">
            
                    
                    Redirects
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.2.8" data-path="add_request_headers.html">
            
                <a href="add_request_headers.html">
            
                    
                    Request Headers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.2.9" data-path="rewrites.html">
            
                <a href="rewrites.html">
            
                    
                    Rewrites
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.2.10" data-path="shadowing.html">
            
                <a href="shadowing.html">
            
                    
                    Traffic Shadowing
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5.1.3" data-path="services/services.html">
            
                <a href="services/services.html">
            
                    
                    External Services
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1.3.1" data-path="services/auth-service.html">
            
                <a href="services/auth-service.html">
            
                    
                    Authentication
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.3.2" data-path="services/rate-limit-service.html">
            
                <a href="services/rate-limit-service.html">
            
                    
                    Rate Limiting
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.3.3" data-path="services/tracing-service.html">
            
                <a href="services/tracing-service.html">
            
                    
                    Tracing
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5.1.4" data-path="advanced.html">
            
                <a href="advanced.html">
            
                    
                    Advanced configuration topics
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="running.html">
            
                <a href="running.html">
            
                    
                    Running Ambassador
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.2.1" data-path="diagnostics.html">
            
                <a href="diagnostics.html">
            
                    
                    Diagnostics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2.2" data-path="ambassador-with-aws.html">
            
                <a href="ambassador-with-aws.html">
            
                    
                    Ambassador with AWS
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5.3" data-path="upgrading.html">
            
                <a href="upgrading.html">
            
                    
                    Upgrading Ambassador
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="5.4" data-path="statistics.html">
            
                <a href="statistics.html">
            
                    
                    Statistics and Monitoring
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Developers</li>
        
        
    
        <li class="chapter " data-level="6.1" >
            
                <a target="_blank" href="https://github.com/datawire/ambassador/blob/master/BUILDING.md">
            
                    
                    Building Ambassador (GitHub)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.2" >
            
                <a target="_blank" href="https://github.com/datawire/ambassador/blob/master/CHANGELOG.md">
            
                    
                    Changelog (GitHub)
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Need Help?</li>
        
        
    
        <li class="chapter " data-level="7.1" >
            
                <a target="_blank" href="https://d6e.co/slack">
            
                    
                    Ask on Slack
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.2" >
            
                <a target="_blank" href="https://github.com/datawire/ambassador/issues/new">
            
                    
                    File a GitHub Issue
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.3" >
            
                <a target="_blank" href="https://www.datawire.io">
            
                    
                    Visit Datawire.io
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        

    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Statistics and Monitoring</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
<a id="datawire-breadcrumb" href="https://datawire.io/learn/open-source-docs">
    â Back to Datawire Open Source Documentation
</a>

                                <h1 id="statistics-and-monitoring">Statistics and Monitoring</h1>
<p>Ambassador is an API gateway for microservices built on <a href="https://lyft.github.io/envoy/" target="_blank">Envoy</a>. A key feature of Envoy is the observability it enables by exposing a multitude of statistics about its own operations. Ambassador makes it easy to direct this information to a statistics and monitoring tool of your choice.</p>
<p>As an example, for a given service <code>usersvc</code>, here are some interesting statistics to investigate:</p>
<ul>
<li><code>envoy.cluster.usersvc_cluster.upstream_rq_total</code> is the total number of requests that <code>usersvc</code> has received via Ambassador. The rate of change of this value is one basic measure of service utilization, i.e. requests per second.</li>
<li><code>envoy.cluster.usersvc_cluster.upstream_rq_2xx</code> is the total number of requests to which <code>usersvc</code> responded with an HTTP response indicating success. This value divided by the prior one, taken on an rolling window basis, represents the recent success rate of the service. There are corresponding <code>4xx</code> and <code>5xx</code> counters that can help clarify the nature of unsuccessful requests.</li>
<li><code>envoy.cluster.usersvc_cluster.upstream_rq_time</code> is a StatsD timer that tracks the latency in milliseconds of <code>usersvc</code> from Ambassador&apos;s perspective. StatsD timers include information about means, standard deviations, and decile values.</li>
</ul>
<h4 id="exposing-statistics-via-statsd">Exposing statistics via StatsD</h4>
<p>Statistics are exposed via the ubiquitous and well-tested <a href="https://github.com/etsy/statsd" target="_blank">StatsD</a> protocol.</p>
<p>To expose statistics via StatsD, you will need to set an environment variable <code>STATSD_ENABLED: true</code> to Ambassador&apos;s Kubernetes Deployment YAML. To set this environment variable, run <code>kubectl edit deployment ambassador</code> and add the variable to <code>spec.template.spec.containers[0].env</code>.</p>
<p>The YAML snippet will look something like -</p>
<pre><code class="lang-yaml">&lt;redacted<span class="hljs-string">&gt;
</span><span class="hljs-attr">    spec:</span>
<span class="hljs-attr">      containers:</span>
<span class="hljs-attr">      - env:</span>
<span class="hljs-attr">        - name:</span> STATSD_ENABLED
<span class="hljs-attr">          value:</span> <span class="hljs-string">&quot;true&quot;</span>
<span class="hljs-attr">        - name:</span> AMBASSADOR_NAMESPACE
<span class="hljs-attr">          valueFrom:</span>
<span class="hljs-attr">            fieldRef:</span>
<span class="hljs-attr">              apiVersion:</span> v1
<span class="hljs-attr">              fieldPath:</span> metadata.namespace
<span class="hljs-attr">        image:</span> &lt;ambassador image<span class="hljs-string">&gt;
</span><span class="hljs-attr">        imagePullPolicy:</span> IfNotPresent
&lt;redacted<span class="hljs-string">&gt;
</span></code></pre>
<p> Ambassador automatically sends statistics information to a Kubernetes service called <code>statsd-sink</code> using typical StatsD protocol settings, UDP to port 8125. We have included a few example configurations in the <a href="https://github.com/datawire/ambassador/tree/master/statsd-sink" target="_blank">statsd-sink</a> subdirectory to help you get started. Clone the repository to get local, editable copies.</p>
<p> You may also override the StatsD host by setting the <code>STATSD_HOST</code> environment variable. This can be useful if you have an existing StatsD sink available in your cluster.</p>
<h2 id="graphite">Graphite</h2>
<p><a href="http://graphite.readthedocs.org/" target="_blank">Graphite</a> is a web-based realtime graphing system. Spin up an example Graphite setup:</p>
<pre><code>kubectl apply -f statsd-sink/graphite/graphite-statsd-sink.yaml
</code></pre><p>This sets up the <code>statsd-sink</code> service and a deployment that contains Graphite and its related infrastructure. Graphite&apos;s web interface is available at <code>http://statsd-sink/</code> from within the cluster. Use port forwarding to access the interface from your local machine:</p>
<pre><code>SINKPOD=$(kubectl get pod -l service=statsd-sink -o jsonpath=&quot;{.items[0].metadata.name}&quot;)
kubectl port-forward $SINKPOD 8080:80
</code></pre><p>This sets up Graphite access at <code>http://localhost:8080/</code>.</p>
<h2 id="prometheus">Prometheus</h2>
<p><a href="https://prometheus.io/" target="_blank">Prometheus</a> is an open-source monitoring and alerting system. If you use Prometheus, you should deploy a StatsD exporter as a sidecar on each of your Ambassador pods as shown in this <a href="https://www.getambassador.io/yaml/ambassador/ambassador-rbac-prometheus.yaml" target="_blank">example</a>.</p>
<p>The <code>statsd-sink</code> service referenced in this example is built on the <a href="https://github.com/prometheus/statsd_exporter" target="_blank">Prometheus StatsD Exporter</a>, and configured in this <a href="https://github.com/datawire/ambassador/blob/master/statsd-sink/prometheus/prom-statsd-exporter/Dockerfile" target="_blank">Dockerfile</a>.</p>
<p>Add a Prometheus target to read from <code>statsd-sink</code> on port 9102 to complete the Prometheus configuration.</p>
<h3 id="configuring-metrics-mappings-for-prometheus">Configuring metrics mappings for Prometheus</h3>
<p>It may be desirable to change how metrics produced by the <code>statsd-sink</code> are named, labeled and grouped.</p>
<p>For example, by default each service that the API Gateway serves will create a new metric using its name. For the service called <code>usersvc</code> you will see this metric: <code>envoy.cluster.usersvc_cluster.upstream_rq_total</code>. This may lead to problems if you are trying to create a single aggregate that is the sum of all similar metrics from different services. In this case it is common to differentiate the metrics for an individual service with a <code>label</code>. This can be done using a mapping.</p>
<p><a href="https://github.com/prometheus/statsd_exporter/tree/v0.6.0#metric-mapping-and-configuration" target="_blank">Follow this guide</a> to learn how to modify your mappings.</p>
<h4 id="configuring-for-helm">Configuring for Helm</h4>
<p>If you deploy using helm the value that you should change is <code>exporter.configuration</code>. Set it to something like this:</p>
<pre><code class="lang-yaml"><span class="hljs-attr">exporter:</span>
<span class="hljs-attr">  configuration:</span> <span class="hljs-string">|
    ---
</span><span class="hljs-attr">    mappings:</span>
<span class="hljs-attr">    - match:</span> <span class="hljs-string">&apos;envoy.cluster.*.upstream_rq_total&apos;</span>
<span class="hljs-attr">      name:</span> <span class="hljs-string">&quot;envoy_cluster_upstream_rq_total&quot;</span>
<span class="hljs-attr">      timer_type:</span> <span class="hljs-string">&apos;histogram&apos;</span>
<span class="hljs-attr">      labels:</span>
<span class="hljs-attr">        cluster_name:</span> <span class="hljs-string">&quot;$1&quot;</span>
</code></pre>
<h4 id="configuring-for-kubectl">Configuring for kubectl</h4>
<p>In the <a href="https://github.com/datawire/ambassador/blob/master/templates/ambassador/ambassador-rbac-prometheus.yaml" target="_blank">ambassador-rbac-prometheus</a> example template there is a <code>ConfigMap</code> that should be updated. Add your mapping to the <code>configuration</code> property.</p>
<pre><code class="lang-yaml"><span class="hljs-meta">---</span>
<span class="hljs-attr">apiVersion:</span> v1
<span class="hljs-attr">kind:</span> ConfigMap
<span class="hljs-attr">metadata:</span>
<span class="hljs-attr">  name:</span> ambassador-config
<span class="hljs-attr">data:</span>
<span class="hljs-attr">  exporterConfiguration:</span> <span class="hljs-string">|
    ---
</span><span class="hljs-attr">    mappings:</span>
<span class="hljs-attr">    - match:</span> <span class="hljs-string">&apos;envoy.cluster.*.upstream_rq_total&apos;</span>
<span class="hljs-attr">      name:</span> <span class="hljs-string">&quot;envoy_cluster_upstream_rq_total&quot;</span>
<span class="hljs-attr">      timer_type:</span> <span class="hljs-string">&apos;histogram&apos;</span>
<span class="hljs-attr">      labels:</span>
<span class="hljs-attr">        cluster_name:</span> <span class="hljs-string">&quot;$1&quot;</span>
</code></pre>
<h3 id="the-prometheus-operator">The Prometheus Operator</h3>
<p>If you don&apos;t already have a Prometheus setup, the <a href="https://github.com/coreos/prometheus-operator" target="_blank">Prometheus operator</a> is a powerful way to create and deploy Prometheus instances. Once you&apos;ve installed and configured the Prometheus operator, the following files can be useful:</p>
<ul>
<li><a href="https://github.com/datawire/ambassador/blob/master/statsd-sink/prometheus/statsd-sink-svc.yaml" target="_blank"><code>statsd-sink-svc.yaml</code></a> creates a <code>service</code> that points to the sidecar <code>statsd-sink</code> on the Ambassador pod, and a <code>ServiceMonitor</code> that adds the <code>statsd-sink</code> as a Prometheus target</li>
<li><a href="https://github.com/datawire/ambassador/blob/master/statsd-sink/prometheus/prometheus.yaml" target="_blank"><code>prometheus.yaml</code></a> creates a <code>Prometheus</code> object that collects data from the <code>ServiceMonitor</code> specified</li>
<li><a href="https://www.getambassador.io/yaml/ambassador/ambassador-rbac-prometheus.yaml" target="_blank"><code>ambassador-rbac-prometheus.yaml</code></a> is an example Ambassador deployment that includes the Prometheus <code>statsd</code> exporter. The statsd exporter collects the stats data from Ambassador, translates it to Prometheus metrics, and is picked up by the Operator using the configurations above.</li>
</ul>
<p>Make sure that the <code>ServiceMonitor</code> is in the same namespace as Ambassador. A walk-through of the basics of configuring the Prometheus operator with Ambassador and Envoy is available <a href="http://www.datawire.io/faster/ambassador-prometheus/" target="_blank">here</a>.</p>
<h3 id="statsd-as-an-independent-deployment">StatsD as an Independent Deployment</h3>
<p>If you want to set up the StatsD sink as an independent deployment, <a href="https://github.com/datawire/ambassador/blob/master/statsd-sink/prometheus/prom-statsd-sink.yaml" target="_blank">this example</a> configuration mirrors the Graphite and Datadog configurations.</p>
<h2 id="grafana">Grafana</h2>
<p><img src="images/grafana.png" alt="Grafana dashboard"></p>
<p>If you&apos;re using Grafana, <a href="https://twitter.com/alex_gervais" target="_blank">Alex Gervais</a> has written a template <a href="https://grafana.com/dashboards/4698" target="_blank">Grafana dashboard for Ambassador</a>.</p>
<h2 id="datadog">Datadog</h2>
<p>If you are a user of the <a href="https://www.datadoghq.com/" target="_blank">Datadog</a> monitoring system, pulling in Ambassador statistics is very easy. Replace the sample API key in the YAML file with your own, then launch the DogStatsD agent:</p>
<pre><code>kubectl apply -f statsd-sink/datadog/dd-statsd-sink.yaml
</code></pre><p>This sets up the <code>statsd-sink</code> service and a deployment of the DogStatsD agent that automatically forwards Ambassador stats to your Datadog account.</p>

                                

                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="upgrading.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page: Upgrading Ambassador">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Statistics and Monitoring","level":"5.4","depth":1,"next":{"title":"Building Ambassador (GitHub)","level":"6.1","depth":1,"url":"https://github.com/datawire/ambassador/blob/master/BUILDING.md","ref":"https://github.com/datawire/ambassador/blob/master/BUILDING.md","articles":[]},"previous":{"title":"Upgrading Ambassador","level":"5.3","depth":1,"path":"reference/upgrading.md","ref":"reference/upgrading.md","articles":[]},"dir":"ltr"},"config":{"plugins":["gtm","anchorjs"],"root":".","styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"gtm":{"token":"GTM-TPMQ838","virtualPageViews":true},"search":{},"layout":{"footerPath":"layouts/footer.html"},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"anchorjs":{"selector":"h2,h3,h4,h5","placement":"right","visible":"always","truncate":64,"ariaLabel":"Anchor"}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"INDEX.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"Ambassador: open source API Gateway for microservices and Kubernetes","gitbook":"*"},"file":{"path":"reference/statistics.md","mtime":"2020-08-25T18:44:25.444Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2020-09-14T18:10:30.972Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>


        
    
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-gtm/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-anchorjs/anchor.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-anchorjs/anchor-style.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    <script src="/js/datawire-breadcrumb.js" type="text/javascript"></script>

    </body>
</html>

